# hybrid-ML-scripts
A collection of Octave scripts and functions to predict the execution time of submitted MapReduce or Tez jobs by using a Hybrid Machine Learning Approach. These m-files depend on LIBSVM. All code in this repository is licensed under the Apache License, version 2.0.## Prerequisites:* Installation of GNU Octave available at www.gnu.org/s/octave* Download the collection of Octave scripts* Obtain response time results from MR and DAG-based Tez job executions. Real experiments are performed on two Hive queries R1 and Q1 respectively and real data samples from 20 to 120 cores are gathered from the OS.## Execution:* Bootstrapped Hybrid performance modeling (R1 Hive Query)* Navigate to bootstrap/octave* Run computeFormulaBasedRTime.m script in order to calculate the estimated response times of MR jobs for different nCores and generate the initial set of synthetic data samples (Knowledge Base-KB).* Finding the optimal thresholds for Hybrid approachFor a fair comparison an optimal combination for iteration and stop thresholds is needed. The optimal combination of the two thresholds represents the values that minimize the MAPE (Mean Absolute Percentage Errors) on the missing configurations. The latter are known from the real experiments but are not fed into the algorithm. - Run "main_hy_weighted_optimum_finding_120_1" to "main_hy_weighted_optimum_finding_120_8" in parallel to generate state space of threshold combinations for Hybrid approach in a folder named ?HyOptimumFinding? in "bootstrap/plots/R1/250/linear/missing_120"- 'itrThr' changes between 25 and 40 while 'stopThr' changes between 15 and 30.-  'seed' changes between 1 to 50 in all the files.- The weights of (analytical, operational) data should be (1, 5).- Run "computeAvgsOfHybridForOptimumFinding.m" to get the average error for each combination of thresholds for Hybrid approach in a file named "avg_hy.csv" in "bootstrap/plots/R1/250/linear/missing_120/HyOptimumFinding" and find the one that minimizes the error. * Finding the optimal thresholds for IML (Iterative Machine Learning) approach (obeys the general structure of algorithm without including Analytical Model)- Run "main_ml_optimum_finding_120_1.m" to "main_ml_optimum_finding_120_8.m" to generate state space of threshold combinations for IML approach in a folder named "MLOptimumFinding" in "bootstrap/plots/R1/250/linear/missing_120"- 'itrThr' changes between 25 and 40, and 'stopThr' changes between 15 and 30. - 'seed' changes between 1 to 50 in all the files- Run "computeAvgsOfMLForOptimumFinding.m" to get the average error for each combination of thresholds for IML approach in a file named "avg_ml.csv" in "bootstrap/plots/R1/250/linear/missing_120/MLOptimumFinding" and find the one that minimizes the error. 	  * Right Extrapolation Phase for R1 QueryIn order to examine the extrapolation capability on many cores in the upper region of the configuration the user should start running a set of m-files using the optimal thresholds obtained from the previous processes. In particular for finding the right extrapolation of Hybrid and BML approaches the steps should be followed are presented below.- At first, run the "main_hy_weighted_combined_120.m" which calculates the extrapolation when only 120 point core is missing.- Accordingly, execute scripts from "main_hy_weighted_combined_120_108.m", "main_hy_weighted_combined_120_108_100.m", 	  "main_hy_weighted_combined_120_108_100_90.m", to "main_hy_weighted_combined_120_108_100_90_80.m" consecutively- Output files named "120", "108", "100", "90", and "80" are generated and located in "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" "bootstrap/plots/R1/250/linear/missing_120/BaseExtrapolate"  files respectively. - Run "computeExtrapolationFromRight.m" to produce the output plots of right extrapolation in "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" folderFor calculating the right extrapolation of IML approach the user should as previous to:- Run "main_ml_120.m", "main_ml_120_108.m", "main_ml_120_108_100.m", "main_ml_120_108_100_90.m", and "main_ml_120_108_100_90_80.m"- output files in "120", "108", "100", "90", and "80" subfolders in "bootstrap/plots/R1/250/linear/missing_120/MLExtrapolate" are generated respectivelyFor generating the output plots of right extrapolation the user should run the "computeExtrapolationFromRight.m". The plots are created in the "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" folder.* Left Extrapolation Phase for R1 QueryFor examing the extrapolation capability in the lower region of the configuration (Left Extrapolation phase) we follow the same process as in Right Extrapolation but this time we should execute a different set of m-files. In particular for finding the extrapolation of Hybrid and BML approaches the user should:- Run "main_hy_weighted_combined_20.m", "main_hy_weighted_combined_20_40.m", "main_hy_weighted_combined_20_40_48.m", 	  "main_hy_weighted_combined_20_40_48_60.m", and "main_hy_weighted_combined_20_40_48_60_72.m" - Output files named "20", "40", "48", "60", and "72" are generateed and located in "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" and	  "bootstrap/plots/R1/250/linear/missing_120/BaseExtrapolate" files respectively.  For calculating the right extrapolation of IML approach the user should as previous to:- Run "main_ml_20.m", "main_ml_20_40.m", "main_ml_20_40_48.m", "main_ml_20_40_48_60.m", and "main_ml_20_40_48_60_72.m" - output files in "20", "40", "48", "60", and "72" are generated and located in "bootstrap/plots/R1/250/linear/missing_120/MLExtrapolate".	  - Run "computeExtrapolationFromLeft_conference_paper.m" to produce the output plots of left extrapolation in 	  "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" folderFor generating the output plots of right extrapolation the user should run the "computeExtrapolationFromLeft.m". The plots are created in the "bootstrap/plots/R1/250/linear/missing_120/HyExtrapolate" folder.* Interpolation Phase for R1 Query In order to examine the interpolation capability of the suggested approach three different scenarios are considered. In each scenario a different number of points/ cores is missing during the execution of the m-files. According to the previous assertion for the Hybrid Interpolation Analysis the user should:- Run "main_hy_weighted_combined_3_points.m", "main_hy_weighted_combined_5_points.m", and "main_hy_weighted_combined_7_points.m" (3,5 and 7 determined the number of missing points/cores)	 - Output files in "3_points", "5_points", and "7_points" are generated and located in "bootstrap/plots/R1/250/linear/missing_120/HyInterpolate" and "bootstrap/plots/R1/250/linear/missing_120/BaseInterpolate" respectively. Concerning the calculation of IML interpolation the user should as previous to:
- Run "main_ml_3_points.m", "main_ml_3_points.m", and "main_ml_3_points.m" to generate output files in "3_points", "5_points", and "7_points" in "bootstrap/plots/R1/250/linear/missing_120/MLInterpolate".	 - The output plots of interpolation are produced in "bootstrap/plots/R1/250/linear/missing_120/HyInterpolate" folder. ##  Tez DAG-based Hybrid performance modeling (Q1 Hive Query)* Navigate to dag/octave file* Run computeFormulaBasedRTime.m script in order to calculate the estimated response times of DAG jobs for different nCores and generate the initial set of synthetic data samples (Knowledge Base-KB). The user should manually change the m file configuration based on Q1 query requirements.* Optimum thresholds(itrThr and stopThr) for Q1 IML approach  In case that the user would prefer to use the same thresholds as in R1 case then he/she should skip the optimum finding phase which is described below:- Run "main_ml_initial_optimum_finding_20_1.m" to "main_ml_initial_optimum_finding_20_8.m" to generate state space of threshold combinations for IML approach in a folder named "MLOptimumFinding" in "dag/plots/Q1/30/linear/missing_20"		- Run "computeAvgsOfMLForOptimumFinding.m" to get the average error for each combination of thresholds for IML approach in a file   named "avg_ml.csv" in "dag/plots/Q1/30/linear/missing_20/MLOptimumFinding" and find the one that minimizes the error. 	Right Extrapolation Phase of Hybrid, BML and IML for Q1 query - Run "main_hy_initial_combined_20.m", "main_hy_initial_combined_20_16.m", "main_hy_initial_combined_20_16_15.m",  "main_hy_initial_combined_20_16_15_12.m", and "main_hy_initial_combined_20_16_15_12_10.m"- output files in "20", "16", "15", "12", and "10" subfolders are generated, in "dag/plots/Q1/30/linear/missing_20/HyExtrapolate" and "dag/plots/Q1/30/linear/missing_20/BaseExtrapolate" paths respectively.- Run "main_ml_initial_20.m", "main_ml_initial_20_16.m", "main_ml_initial_20_16_15.m", "main_ml_initial_20_16_15_12.m", and   "main_ml_initial_20_16_15_12_10.m" to generate output files in "20", "16", "15", "12", and "10" subfolders, in "dag/plots/Q1/30/linear/missing_20/MLExtrapolate" paths respectively.- For generating the plots the user should run  "computeExtrapolationFromRight.m". The output is located in "dag/plots/Q1/30/linear/missing_20/HyExtrapolate" folder## Left Extrapolation  Phase of Hybrid, BML and IML for Q1 query* For Hybrid and BML left extrapolation the user should:- Run "main_hy_initial_combined_2.m", "main_hy_initial_combined_2_3.m", "main_hy_initial_combined_2_3_4.m",   "main_hy_initial_combined_2_3_4_5.m", and "main_hy_initial_combined_2_3_4_5_6.m" to generate output files in "2", "3", "4", "5", and "6" subfolders, in both "dag/plots/Q1/30/linear/missing_20/HyExtrapolate" and	  "dag/plots/Q1/30/linear/missing_20/BaseExtrapolate" respectively.
* For IML left extrapolation:	- Run "main_ml_initial_2.m", "main_ml_initial_2_3.m", "main_ml_initial_2_3_4.m", "main_ml_initial_2_3_4_5.m", and   "main_ml_initial_2_3_4_5_6.m" to generate output files in "2", "3", "4", "5", and "6" subfolders, respectively in "dag/plots/Q1/30/linear/missing_20/MLExtrapolate".- Run "computeExtrapolationFromLeft.m" to produce the output plots of left extrapolation in   "dag/plots/Q1/30/linear/missing_20/HyExtrapolate" folder	## Interpolation Phase of Hybrid, BML and IML for Q1 query* Calculating the Hybrid and BML interpolation- Run "main_hy_initial_combined_4_points.m", "main_hy_initial_combined_6_points.m", and "main_hy_initial_combined_8_points.m" to generate 	  output files in "4_points", "6_points", and "8_points" subfolders, respectively of both "dag/plots/Q1/30/linear/missing_20/HyInterpolate" 	  and "dag/plots/Q1/30/linear/missing_20/BaseInterpolate".- Run "main_ml_initial_4_points.m", "main_ml_initial_6_points.m", and "main_ml_initial_8_points.m" to generate output files in 	  "4_points", "6_points", and "8_points" subfolders, respectively in "dag/plots/Q1/30/linear/missing_20/MLInterpolate".	  Then, this folder will contain data needed for interpolation analysis of IML approach.	  (Check to confirm that the 'seed' changes between 1 to 50 in all the files)- Run "computeInterpolation.m" to produce the output plots of interpolation in   	  "dag/plots/Q1/30/linear/missing_20/HyInterpolate" folder 